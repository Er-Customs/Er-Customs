<!-- {% load static %} -->
<!DOCTYPE html>
<html lang="en">

<head>

	<title>Login</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="google-signin-client_id" content="YOUR_CLIENT_ID.apps.googleusercontent.com">
	<!--===============================================================================================-->
	<link rel="icon" type="image/icon" href="/images/favicon.ico">
	<!--===============================================================================================-->
	<link rel="stylesheet" href="/css/bootstrap.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/css/font-awesome.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/css/animate.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/css/hamburgers.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/css/select2.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/css/util.css">
	<link rel="stylesheet" type="text/css" href="/css/main.css">


	<!--===============================================================================================-->
</head>

<body>
	<!-- {% for message in messages %}
	<div class="alert alert-{{ message.tags }} mb-0 alert-dismissible fade show" role="alert">
		<strong>Message: </strong> {{ message }}
		<button type="button" class="close" data-dismiss="alert" aria-label="Close">
			<span aria-hidden="true">&times;</span>
		</button>
	</div>
	{% endfor %} -->
	<div class="limiter">
		<div class="container-login100">
			<div class="wrap-login100">
				<div class="login100-pic js-tilt" data-tilt>
					<img src="/css/img-01.png" alt="IMG">
				</div>

				<form class="login100-form validate-form" action="/login">
					<!-- {% csrf_token %} -->
					<span class="login100-form-title">
						Login
					</span>

					<div class="wrap-input100 validate-input" data-validate="Valid email is required: ex@abc.xyz">
						<input class="input100" type="text" name="email" placeholder="Email">
						<div class="email error"></div>
						<span class="focus-input100"></span>
						<span class="symbol-input100">
							<i class="fa fa-envelope" aria-hidden="true"></i>
						</span>
					</div>

					<div class="wrap-input100 validate-input" data-validate="Password is required">
						<input class="input100" type="password" name="password" placeholder="Password">
						<div class="password error"></div>
						<span class="focus-input100"></span>
						<span class="symbol-input100">
							<i class="fa fa-lock" aria-hidden="true"></i>
						</span>
					</div>

					<div class="container-login100-form-btn">
						<button class="login100-form-btn">
							Login
						</button>
					</div>

					<div class="text-center p-t-20">
						<span class="txt1">
							Forgot
						</span>
						<a class="txt2" href="#">
							Password?
						</a>
					</div>
					<div class="logo">
						<div class="continue_with_google_block">
							<!-- <img src="https://img.icons8.com/color/48/000000/google-logo.png" class="google"> -->
							<div id="my-signin2"></div>
							<script>
								function onSuccess(googleUser) {
									console.log('Logged in as: ' + googleUser.getBasicProfile().getName());
								}
								function onFailure(error) {
									console.log(error);
								}
								function renderButton() {
									gapi.signin2.render('my-signin2', {
										'scope': 'profile email',
										'width': 240,
										'height': 50,
										'longtitle': true,
										'theme': 'dark',
										'onsuccess': onSuccess,
										'onfailure': onFailure
									});
								}
							</script>

							<script src="https://apis.google.com/js/platform.js?onload=renderButton" async
								defer></script>
						</div>
					</div>
					<div class="text-center p-t-60">
						<a class="txt2" href="/signup">
							Create your Account
							<i class="fa fa-long-arrow-right m-l-5" aria-hidden="true"></i>
						</a>
					</div>
				</form>
			</div>
		</div>
	</div>




	<!--===============================================================================================-->
	<script src="/css/jquery-3.2.1.min.js"></script>
	<!--===============================================================================================-->
	<script src="/css/popper.js"></script>
	<script src="/css/bootstrap.min.js"></script>
	<!--===============================================================================================-->
	<script src="/css/select2.min.js"></script>
	<!--===============================================================================================-->
	<script src="/css/tilt.jquery.min.js"></script>
	<script>
		$('.js-tilt').tilt({
			scale: 1.1
		})
	</script>
	<!--===============================================================================================-->
	<script src="/css/main.js"></script>

</body>
<script>
	const form = document.querySelector('form');
	const emailError = document.querySelector('.email.error');
	const passwordError = document.querySelector('.password.error');

	form.addEventListener('submit', async (e) => {
		e.preventDefault();

		// reset errors
		emailError.textContent = '';
		passwordError.textContent = '';

		// get values
		const email = form.email.value;
		const password = form.password.value;

		try {
			const res = await fetch('/login', {
				method: 'POST',
				body: JSON.stringify({ email, password }),
				headers: { 'Content-Type': 'application/json' }
			});
			const data = await res.json();
			console.log(data);
			if (data.errors) {
				emailError.textContent = data.errors.email;
				passwordError.textContent = data.errors.password;
			}
			if (data.user) {
				location.assign('/');
			}

		}
		catch (err) {
			alert(err);
		}

	});
</script>

</html>